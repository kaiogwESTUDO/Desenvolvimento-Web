<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notas dos Alunos</title>
    <style>
        .media {
            background-color: white;
            font-weight: bold;
        }
    </style>
</head>
<body>

    <h2>Notas dos Alunos</h2>

    <table border="1px" width="100%" id="tabelaNotas">
        <tr bgcolor="gray">
            <th rowspan="2">Aluno</th>
            <th colspan="3">Semestre 1</th>
            <th colspan="3">Semestre 2</th>
            <th colspan="3">Semestre 3</th>
            <th rowspan="2">Média Linha</th>
        </tr>
        <tr>
            <th>Nota 1</th>
            <th>Nota 2</th>
            <th>Nota 3</th>
            <th>Nota 1</th>
            <th>Nota 2</th>
            <th>Nota 3</th>
            <th>Nota 1</th>
            <th>Nota 2</th>
            <th>Nota 3</th>
        </tr>
        <tr>
            <td>João</td>
            <td contenteditable="true">10</td>
            <td contenteditable="true">8</td>
            <td contenteditable="true">9</td>
            <td contenteditable="true">6</td>
            <td contenteditable="true">8.7</td>
            <td contenteditable="true">10</td>
            <td contenteditable="true">6</td>
            <td contenteditable="true">7</td>
            <td contenteditable="true">9</td>
            <td class="media"></td>
        </tr>
        <tr>
            <td>Maria</td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td class="media"></td>
        </tr>
        <tr>
            <td>José</td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td class="media"></td>
        </tr>
        <tr>
            <td>Paulo</td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td class="media"></td>
        </tr>
        <tr>
            <td>Miguel</td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td class="media"></td>
        </tr>
        <tr>
            <td>Julia</td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td class="media"></td>
        </tr>
        <tr class="media">
            <td>Média Coluna</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
    </table>

    <br>
    
    <button onclick="calcularMediaColunas()">Calcular Média por Nota (Coluna)</button>
    <button onclick="calcularMediaLinhas()">Calcular Média por Aluno (Linha)</button>

    <script>
        function calcularMediaLinhas() {
            let tabela = document.getElementById("tabelaNotas");
            for (let i = 2; i < tabela.rows.length - 1; i++) {
                let soma = 0;
                let count = 0;
                for (let j = 1; j <= 9; j++) {
                    let valor = tabela.rows[i].cells[j].innerText;
                    if (valor !== "") {
                        soma += parseFloat(valor);
                        count++;
                    }
                }
                let media = count > 0 ? (soma / count).toFixed(2) : "-";
                tabela.rows[i].cells[10].innerText = media;
            }
        }

        function calcularMediaColunas() {
            let tabela = document.getElementById("tabelaNotas");
            let ultimaLinha = tabela.rows[tabela.rows.length - 1];
            for (let j = 1; j <= 9; j++) {
                let soma = 0;
                let count = 0;
                for (let i = 2; i < tabela.rows.length - 1; i++) {
                    let valor = tabela.rows[i].cells[j].innerText;
                    if (valor !== "") {
                        soma += parseFloat(valor);
                        count++;
                    }
                }
                let media = count > 0 ? (soma / count).toFixed(2) : "-";
                ultimaLinha.cells[j].innerText = media;
            }
        }
    </script>
</body>
</html>
